"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

/// "PRIVATE" FUNCTIONS

function pathLength(points) {
    var d = 0.0;
    for (var i = 1; i < points.length; i++) {
        d += distance(points[i - 1], points[i]);
    }return d;
}

function boundingBox(points) {
    var minX = +Infinity,
        maxX = -Infinity,
        minY = +Infinity,
        maxY = -Infinity;
    for (var i = 0; i < points.length; i++) {
        minX = Math.min(minX, points[i][0]);
        minY = Math.min(minY, points[i][1]);
        maxX = Math.max(maxX, points[i][0]);
        maxY = Math.max(maxY, points[i][1]);
    }
    return [maxX - minX, maxY - minY];
}

function centroid(points) {
    var x = 0.0,
        y = 0.0;
    for (var i = 0; i < points.length; i++) {
        x += points[i][0];
        y += points[i][1];
    }
    x /= points.length;
    y /= points.length;
    return [x, y];
}
function indicativeAngle(points) {
    var c = centroid(points);
    return Math.atan2(c[1] - points[0][1], c[0] - points[0][0]);
}

/// "PUBLIC" FUNCTIONS

function distance(vector1, vector2) {
    var dist = 0.0;

    if (undefined != vector1 && undefined != vector2) {
        for (var d = 0; d < vector1.length; d++) {
            dist += Math.pow(vector1[d] - vector2[d], 2);
        }
    }
    return Math.sqrt(dist);
}

function resample(data_, n) {
    var data = data_;
    var I = pathLength(data) / (n - 1); // interval length
    var D = 0.0;
    var newpoints = [];
    newpoints.push(data[0]);
    for (var i = 1; i < data.length; i++) {
        var d = distance(data[i - 1], data[i]);
        if (D + d >= I) {
            var qx = data[i - 1][0] + (I - D) / d * (data[i][0] - data[i - 1][0]);
            var qy = data[i - 1][1] + (I - D) / d * (data[i][1] - data[i - 1][1]);
            var q = [qx, qy];
            newpoints.push([qx, qy]);
            data.splice(i, 0, q); // insert 'q' at position i in points s.t. 'q' will be the next i
            D = 0.0;
        } else D += d;
    }
    if (newpoints.length == n - 1) {
        newpoints.push([data[data.length - 1][0], data[data.length - 1][1]]);
    }
    return newpoints;
}

function rotate(points) // rotates points around centroid
{
    var radians = 0.523;
    var c = centroid(points);
    var cos = Math.cos(radians);
    var sin = Math.sin(radians);
    var newpoints = [];
    for (var i = 0; i < points.length; i++) {
        var qx = (points[i][0] - c[0]) * cos - (points[i][1] - c[1]) * sin + c[0];
        var qy = (points[i][0] - c[0]) * sin + (points[i][1] - c[1]) * cos + c[1];
        newpoints.push([qx, qy]);
    }
    return newpoints;
}

function scale(points) // non-uniform scale; assumes 2D gestures (i.e., no lines)
{
    var size = 500;
    var bBox = boundingBox(points);
    var newpoints = [];
    for (var i = 0; i < points.length; i++) {
        var qx = points[i][0] * (size / bBox[0]);
        var qy = points[i][1] * (size / bBox[1]);
        newpoints.push([qx, qy]);
    }
    return newpoints;
}

function translateToOrigin(points) // translates points' centroid
{
    var orig = [0, 0];
    var c = centroid(points);
    var newpoints = [];
    for (var i = 0; i < points.length; i++) {
        var qx = points[i][0] + orig[0] - c[0];
        var qy = points[i][1] + orig[1] - c[1];
        newpoints.push([qx, qy]);
    }
    return newpoints;
}

function reverse(points) {
    var newpoints = [];
    for (var i = points.length - 1; i >= 0; i--) {
        var nx = points[i][0];
        var ny = points[i][1];
        newpoints.push([nx, ny]);
    }
    return newpoints;
}

exports.distance = distance;
exports.resample = resample;
exports.rotate = rotate;
exports.scale = scale;
exports.translateToOrigin = translateToOrigin;
exports.reverse = reverse;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzLmpzIl0sIm5hbWVzIjpbInBhdGhMZW5ndGgiLCJwb2ludHMiLCJkIiwiaSIsImxlbmd0aCIsImRpc3RhbmNlIiwiYm91bmRpbmdCb3giLCJtaW5YIiwiSW5maW5pdHkiLCJtYXhYIiwibWluWSIsIm1heFkiLCJNYXRoIiwibWluIiwibWF4IiwiY2VudHJvaWQiLCJ4IiwieSIsImluZGljYXRpdmVBbmdsZSIsImMiLCJhdGFuMiIsInZlY3RvcjEiLCJ2ZWN0b3IyIiwiZGlzdCIsInVuZGVmaW5lZCIsInBvdyIsInNxcnQiLCJyZXNhbXBsZSIsImRhdGFfIiwibiIsImRhdGEiLCJJIiwiRCIsIm5ld3BvaW50cyIsInB1c2giLCJxeCIsInF5IiwicSIsInNwbGljZSIsInJvdGF0ZSIsInJhZGlhbnMiLCJjb3MiLCJzaW4iLCJzY2FsZSIsInNpemUiLCJiQm94IiwidHJhbnNsYXRlVG9PcmlnaW4iLCJvcmlnIiwicmV2ZXJzZSIsIm54IiwibnkiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUNBOztBQUVBLFNBQVNBLFVBQVQsQ0FBb0JDLE1BQXBCLEVBQ0E7QUFDSSxRQUFJQyxJQUFJLEdBQVI7QUFDQSxTQUFLLElBQUlDLElBQUksQ0FBYixFQUFnQkEsSUFBSUYsT0FBT0csTUFBM0IsRUFBbUNELEdBQW5DO0FBQ0lELGFBQUtHLFNBQVNKLE9BQU9FLElBQUksQ0FBWCxDQUFULEVBQXdCRixPQUFPRSxDQUFQLENBQXhCLENBQUw7QUFESixLQUVBLE9BQU9ELENBQVA7QUFDSDs7QUFFRCxTQUFTSSxXQUFULENBQXFCTCxNQUFyQixFQUNBO0FBQ0ksUUFBSU0sT0FBTyxDQUFDQyxRQUFaO0FBQUEsUUFBc0JDLE9BQU8sQ0FBQ0QsUUFBOUI7QUFBQSxRQUF3Q0UsT0FBTyxDQUFDRixRQUFoRDtBQUFBLFFBQTBERyxPQUFPLENBQUNILFFBQWxFO0FBQ0EsU0FBSyxJQUFJTCxJQUFJLENBQWIsRUFBZ0JBLElBQUlGLE9BQU9HLE1BQTNCLEVBQW1DRCxHQUFuQyxF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LENBQVY7QUFDQSxRQUFJZ0MsWUFBWSxFQUFoQjtBQUNBLFNBQUssSUFBSTlCLElBQUksQ0FBYixFQUFnQkEsSUFBSUYsT0FBT0csTUFBM0IsRUFBbUNELEdBQW5DLEVBQXdDO0FBQ3BDLFlBQUlnQyxLQUFLbEMsT0FBT0UsQ0FBUCxFQUFVLENBQVYsSUFBZTRDLEtBQUssQ0FBTCxDQUFmLEdBQXlCNUIsRUFBRSxDQUFGLENBQWxDO0FBQ0EsWUFBSWlCLEtBQUtuQyxPQUFPRSxDQUFQLEVBQVUsQ0FBVixJQUFlNEMsS0FBSyxDQUFMLENBQWYsR0FBeUI1QixFQUFFLENBQUYsQ0FBbEM7QUFDQWMsa0JBQVVDLElBQVYsQ0FBZSxDQUFDQyxFQUFELEVBQUtDLEVBQUwsQ0FBZjtBQUNIO0FBQ0QsV0FBT0gsU0FBUDtBQUNIOztBQUVELFNBQVNlLE9BQVQsQ0FBaUIvQyxNQUFqQixFQUNBO0FBQ0MsUUFBSWdDLFlBQVksRUFBaEI7QUFDQSxTQUFJLElBQUk5QixJQUFJRixPQUFPRyxNQUFQLEdBQWdCLENBQTVCLEVBQStCRCxLQUFLLENBQXBDLEVBQXVDQSxHQUF2QyxFQUE0QztBQUMzQyxZQUFJOEMsS0FBS2hELE9BQU9FLENBQVAsRUFBVSxDQUFWLENBQVQ7QUFDQSxZQUFJK0MsS0FBS2pELE9BQU9FLENBQVAsRUFBVSxDQUFWLENBQVQ7QUFDQThCLGtCQUFVQyxJQUFWLENBQWUsQ0FBQ2UsRUFBRCxFQUFJQyxFQUFKLENBQWY7QUFDQTtBQUNELFdBQU9qQixTQUFQO0FBQ0E7O1FBR1E1QixRLEdBQUFBLFE7UUFBVXNCLFEsR0FBQUEsUTtRQUFVWSxNLEdBQUFBLE07UUFBUUksSyxHQUFBQSxLO1FBQU9HLGlCLEdBQUFBLGlCO1FBQW1CRSxPLEdBQUFBLE8iLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbi8vLyBcIlBSSVZBVEVcIiBGVU5DVElPTlNcblxuZnVuY3Rpb24gcGF0aExlbmd0aChwb2ludHMpXG57XG4gICAgdmFyIGQgPSAwLjA7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspXG4gICAgICAgIGQgKz0gZGlzdGFuY2UocG9pbnRzW2kgLSAxXSwgcG9pbnRzW2ldKTtcbiAgICByZXR1cm4gZDtcbn1cblxuZnVuY3Rpb24gYm91bmRpbmdCb3gocG9pbnRzKVxue1xuICAgIGxldCBtaW5YID0gK0luZmluaXR5LCBtYXhYID0gLUluZmluaXR5LCBtaW5ZID0gK0luZmluaXR5LCBtYXhZID0gLUluZmluaXR5O1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIG1pblggPSBNYXRoLm1pbihtaW5YLCBwb2ludHNbaV1bMF0pO1xuICAgICAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgcG9pbnRzW2ldWzFdKTtcbiAgICAgICAgbWF4WCA9IE1hdGgubWF4KG1heFgsIHBvaW50c1tpXVswXSk7XG4gICAgICAgIG1heFkgPSBNYXRoLm1heChtYXhZLCBwb2ludHNbaV1bMV0pO1xuICAgIH1cbiAgICByZXR1cm4gW21heFggLSBtaW5YLCBtYXhZIC0gbWluWV07XG59XG5cbmZ1bmN0aW9uIGNlbnRyb2lkKHBvaW50cylcbntcbiAgICB2YXIgeCA9IDAuMCwgeSA9IDAuMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvaW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB4ICs9IHBvaW50c1tpXVswXTtcbiAgICAgICAgeSArPSBwb2ludHNbaV1bMV07XG4gICAgfVxuICAgIHggLz0gcG9pbnRzLmxlbmd0aDtcbiAgICB5IC89IHBvaW50cy5sZW5ndGg7XG4gICAgcmV0dXJuIFt4LCB5XTtcbn1cbmZ1bmN0aW9uIGluZGljYXRpdmVBbmdsZShwb2ludHMpXG57XG4gICAgdmFyIGMgPSBjZW50cm9pZChwb2ludHMpO1xuICAgIHJldHVybiBNYXRoLmF0YW4yKGNbMV0gLSBwb2ludHNbMF1bMV0sIGNbMF0gLSBwb2ludHNbMF1bMF0pO1xufVxuXG5cbi8vLyBcIlBVQkxJQ1wiIEZVTkNUSU9OU1xuXG5mdW5jdGlvbiBkaXN0YW5jZSh2ZWN0b3IxLCB2ZWN0b3IyKSB7XG5cdGxldCBkaXN0ID0gMC4wO1xuXHRcblx0aWYodW5kZWZpbmVkICE9IHZlY3RvcjEgJiYgdW5kZWZpbmVkICE9IHZlY3RvcjIpe1xuXHRcdGZvciAobGV0IGQgPTA7IGQgPCB2ZWN0b3IxLmxlbmd0aDsgZCsrKSB7XG5cdFx0XHRkaXN0ICs9IE1hdGgucG93KHZlY3RvcjFbZF0gLSB2ZWN0b3IyW2RdLCAyKTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIE1hdGguc3FydChkaXN0KTtcbn1cblxuZnVuY3Rpb24gcmVzYW1wbGUoZGF0YV8sIG4pXG57ICAgXG4gICAgbGV0IGRhdGEgPSBkYXRhXztcbiAgICBsZXQgSSA9IHBhdGhMZW5ndGgoZGF0YSkgLyAobiAtIDEpOyAvLyBpbnRlcnZhbCBsZW5ndGhcbiAgICBsZXQgRCA9IDAuMDtcbiAgICBsZXQgbmV3cG9pbnRzID0gW107XG4gICAgbmV3cG9pbnRzLnB1c2goZGF0YVswXSlcbiAgICBmb3IgKGxldCBpID0gMTsgaSA8IGRhdGEubGVuZ3RoOyBpKyspXG4gICAge1xuICAgICAgICBsZXQgZCA9IGRpc3RhbmNlKGRhdGFbaSAtIDFdLCBkYXRhW2ldKTtcbiAgICAgICAgaWYgKChEICsgZCkgPj0gSSlcbiAgICAgICAge1xuICAgICAgICAgICAgbGV0IHF4ID0gZGF0YVtpIC0gMV1bMF0gKyAoKEkgLSBEKSAvIGQpICogKGRhdGFbaV1bMF0gLSBkYXRhW2kgLSAxXVswXSk7XG4gICAgICAgICAgICBsZXQgcXkgPSBkYXRhW2kgLSAxXVsxXSArICgoSSAtIEQpIC8gZCkgKiAoZGF0YVtpXVsxXSAtIGRhdGFbaSAtIDFdWzFdKTtcbiAgICAgICAgICAgIGxldCBxID0gW3F4LCBxeV07XG4gICAgICAgICAgICBuZXdwb2ludHMucHVzaChbcXgsIHF5XSk7XG4gICAgICAgICAgICBkYXRhLnNwbGljZShpLCAwLCBxKTsgLy8gaW5zZXJ0ICdxJyBhdCBwb3NpdGlvbiBpIGluIHBvaW50cyBzLnQuICdxJyB3aWxsIGJlIHRoZSBuZXh0IGlcbiAgICAgICAgICAgIEQgPSAwLjA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBEICs9IGQ7XG4gICAgfVxuICAgIGlmIChuZXdwb2ludHMubGVuZ3RoID09IG4gLSAxKSB7XG4gICAgICAgIG5ld3BvaW50cy5wdXNoKFtkYXRhW2RhdGEubGVuZ3RoIC0gMV1bMF0sIGRhdGFbZGF0YS5sZW5ndGggLSAxXVsxXV0pO1xuICAgIH1cbiAgICByZXR1cm4gbmV3cG9pbnRzO1xufVxuXG5cbmZ1bmN0aW9uIHJvdGF0ZShwb2ludHMpIC8vIHJvdGF0ZXMgcG9pbnRzIGFyb3VuZCBjZW50cm9pZFxue1xuICAgIGxldCByYWRpYW5zID0gMC41MjM7XG4gICAgbGV0IGMgPSBjZW50cm9pZChwb2ludHMpO1xuICAgIGxldCBjb3MgPSBNYXRoLmNvcyhyYWRpYW5zKTtcbiAgICBsZXQgc2luID0gTWF0aC5zaW4ocmFkaWFucyk7XG4gICAgbGV0IG5ld3BvaW50cyA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCBxeCA9IChwb2ludHNbaV1bMF0gLSBjWzBdKSAqIGNvcyAtIChwb2ludHNbaV1bMV0gLSBjWzFdKSAqIHNpbiArIGNbMF1cbiAgICAgICAgbGV0IHF5ID0gKHBvaW50c1tpXVswXSAtIGNbMF0pICogc2luICsgKHBvaW50c1tpXVsxXSAtIGNbMV0pICogY29zICsgY1sxXTtcbiAgICAgICAgbmV3cG9pbnRzLnB1c2goW3F4LCBxeV0pO1xuICAgIH1cbiAgICByZXR1cm4gbmV3cG9pbnRzO1xufVxuXG5cbmZ1bmN0aW9uIHNjYWxlKHBvaW50cykgLy8gbm9uLXVuaWZvcm0gc2NhbGU7IGFzc3VtZXMgMkQgZ2VzdHVyZXMgKGkuZS4sIG5vIGxpbmVzKVxue1xuICAgIGxldCBzaXplID0gNTAwO1xuICAgIGxldCBiQm94ID0gYm91bmRpbmdCb3gocG9pbnRzKTtcbiAgICBsZXQgbmV3cG9pbnRzID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IHF4ID0gcG9pbnRzW2ldWzBdICogKHNpemUgLyBiQm94WzBdKTtcbiAgICAgICAgbGV0IHF5ID0gcG9pbnRzW2ldWzFdICogKHNpemUgLyBiQm94WzFdKTtcbiAgICAgICAgbmV3cG9pbnRzLnB1c2goW3F4LCBxeV0pO1xuICAgIH1cbiAgICByZXR1cm4gbmV3cG9pbnRzO1xufVxuXG5mdW5jdGlvbiB0cmFuc2xhdGVUb09yaWdpbihwb2ludHMpIC8vIHRyYW5zbGF0ZXMgcG9pbnRzJyBjZW50cm9pZFxue1xuICAgIGNvbnN0IG9yaWcgPSBbMCwgMF07XG4gICAgY29uc3QgYyA9IGNlbnRyb2lkKHBvaW50cyk7XG4gICAgbGV0IG5ld3BvaW50cyA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCBxeCA9IHBvaW50c1tpXVswXSArIG9yaWdbMF0gLSBjWzBdO1xuICAgICAgICBsZXQgcXkgPSBwb2ludHNbaV1bMV0gKyBvcmlnWzFdIC0gY1sxXTtcbiAgICAgICAgbmV3cG9pbnRzLnB1c2goW3F4LCBxeV0pO1xuICAgIH1cbiAgICByZXR1cm4gbmV3cG9pbnRzO1xufVxuXG5mdW5jdGlvbiByZXZlcnNlKHBvaW50cylcbntcblx0bGV0IG5ld3BvaW50cyA9IFtdO1xuXHRmb3IobGV0IGkgPSBwb2ludHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRsZXQgbnggPSBwb2ludHNbaV1bMF07XG5cdFx0bGV0IG55ID0gcG9pbnRzW2ldWzFdO1xuXHRcdG5ld3BvaW50cy5wdXNoKFtueCxueV0pO1xuXHR9XHRcblx0cmV0dXJuIG5ld3BvaW50cztcbn1cblxuXG5leHBvcnQgeyBkaXN0YW5jZSwgcmVzYW1wbGUsIHJvdGF0ZSwgc2NhbGUsIHRyYW5zbGF0ZVRvT3JpZ2luLCByZXZlcnNlIH07XG4iXX0=